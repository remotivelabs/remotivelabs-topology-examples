schema: remotive-topology-instance:0.12

containers:
  tester:
    profiles: [tester]
    build:
      dockerfile: ../Dockerfile
    volumes:
      - ../containers/tester:/app
    working_dir: /app
    command: "pytest --broker_url=http://topology-broker.com:50051 -s -vv"
    depends_on:
      - sccm-mock
      - bcm
      - DIM-broker.com
      - FLCM-broker.com
      - RLCM-broker.com
      - gwm
      - ihu
    environment:  
      - CLOUD_URL=${CLOUD_URL}
      - CLOUD_AUTH=${CLOUD_AUTH}

  behave:
    profiles: [behave]
    build:
      dockerfile: ../Dockerfile
    volumes:
      - ../containers/behave:/app
    working_dir: /app
    command: "behave features --define broker_url=http://topology-broker.com:50051"
    depends_on:
      - sccm-mock
      - bcm
      - DIM-broker.com
      - FLCM-broker.com
      - RLCM-broker.com
      - gwm
      - ihu
